<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro para clientes JAVER - by Dorian raygoza</title>
    <link 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" 
        rel="stylesheet" 
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" 
        crossorigin="anonymous" 
    />
    <style>
        body {
            background-color: #e0030a;
        }

        form {
            background-color: white;
            margin-top: 30px;
            border-radius: 20px;
            font-size: 40px !important;
            width: min(1800px, 90%);
        }
        
        .calendly-container {
            display: none;
            width: 100%;
            overflow-x: auto;
        }

        .label {
            font-size: 22px;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            color: #e0030a
        }

        .importantMessage {
            font-size: 18px;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            color: red;
        }

        @media screen and (max-width: 600px) {
            .imgLogo {
                width: 70%;
            }

            .importantMessage {
            font-size: 12px;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            color: red;
        }
        }

        .span {
            color: white;
            text-decoration: none;
        }

        .span-name {
            color: white;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <form
        id = "form"
        class = "mx-auto my-5 shadow p-2"
        method = "POST"
    >

    <div class="d-flex justify-content-center">
        <img class="mt-5 img-fluid imgLogo" src="https://drive.google.com/thumbnail?id=1fmmlXIwqD0BEz3CCZymhKFrxkvP6kLIB&sz=s400" alt="javer logo" />
    </div>

    <div class="justify-content-center">
        <h2 class="mt-3 p-2 text-center"> Registro de cliente - <strong> ASESOR OCTAVIO </strong></h2>
    </div>
    <!-- action= will be set by javascript -->
        <div class="mb-1">
            <label for="nombre completo" class="label form-label">Nombre completo</label>
            <input type="text" name="Nombre completo" id="nombreCompleto" class="form-control" placeholder="Nombre completo" required />
        </div>

        <div class="row mt-2 p-2">
            <div class="col-lg-4 col-md-12">
              <div class="mb-3">
                <label for="nss" class="label form-label">NSS</label>
                <input type="number" class="form-control" name="NSS" id="nss" placeholder="NSS Numero Seguro Social" aria-label="NSS" required>
                <div class="invalid-feedback">
                  Ingresa un numero de seguro social valido
                </div>
              </div>
            </div>
            <div class="col-lg-4 col-md-12">
              <div class="mb-3">
                <label for="telefono" class="label form-label">Télefono</label>
                <input type="phone" class="form-control" name="Telefono" id="telefono" placeholder="Telefono" aria-label="telefono" required>
                <div class="invalid-feedback">
                  Ingresa un numero de telefono valido
                </div>
              </div>
            </div>
            <div class="col-lg-4 col-md-12">
              <div class="mb-3">
                <label for="correo" class="label form-label">Correo / Email</label>
                <input type="email" class="form-control" name="Correo" id="correo" placeholder="ejemplo@gmail.com" aria-label="correo" required>
                <div class="invalid-feedback">
                  Ingresa una direccion de correo valida
                </div>
              </div>
            </div>
        </div>

        <div class="row mt-2 p-2">
            <div class="col-lg-6 col-md-12">
              <div class="mb-3">
                <label for="fraccionamiento" class="label form-label">Fraccionamiento</label>
                <select class="form-select" id="fraccionamiento" name="Fraccionamiento">
                  <option value="Valle de Tejeda - Tlajomulco de Zuñiga"> Valle de Tejeda - Tlajomulco de Zuñiga </option>
                  <option value="Vista de la Reyna - Tonala"> Vista de la Reyna - Tonala </option>
                  <option value="Cima Serena - El Salto"> Cima Serena - El Salto </option>
                </select>
              </div>
            </div>
  
            <div class="col-lg-6 col-md-12">
              <div class="mb-3">
                <label for="quien genero el cliente" class="label form-label">¿Cómo se entero de mi?</label>
                <select class="form-select" id="formadecontacto" name="Quien genero el cliente">
                  <option value="Redes Sociales"> Redes sociales </option>
                  <option value="Referencia"> Referencia </option>
                  <option value="Volante informativo"> Volante informativo </option>
                </select>
              </div>
            </div>
          </div>

          <div class="mb-3 mt-3 p-2 text-center">
            <h3 class="label">¿Quieres agendar una visita a las oficinas?</h3>
          </div>
  
          <div class="d-flex justify-content-center">
            <div class="row text-center">
              <div class="col-lg-6 col-md-12">
                <div class="form-check">
                  <input type="checkbox" class="form-check-input" name="Si visita" id="siVisita"/>
                  <label for="siVisita" class="label form-check-label">Si</label>
                </div>
              </div>
              <div class="col-lg-6 col-md-12">
                <div class="form-check">
                  <input type="checkbox" class="form-check-input" name="No visita" id="noVisita"/>
                  <label for="noVisita" class="label form-check-label">No</label>
                </div>
              </div>
            </div>
          </div>
  
          <div class="calendly-container" id="calendlyContainer">
            <div class="calendly-inline-widget" data-url="https://calendly.com/doriansamuelraygozaalvarado/cita-para-ejecutivo-de-ventas-javer?text_color=060606" style="min-width:320px;height:700px;"></div>
            <script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js" async></script>
  
            <div class="d-flex justify-content-center">
              <p class="importantMessage" > <strong> IMPORTANTE: </strong> Una vez que el evento sea agendado por favor haz click en el boton de abajo para enviar tu informacion </p>
            </div>
          </div>

          <div class="mb-3 mt-4 p-2 d-flex justify-content-center">
            <div class="form-check">
              <label for="acuerdoprivacidad" class="label form-check-label">Acepto el acuerdo de privacidad de mis datos</label>
              <input type="checkbox" class="form-check-input" name="Acuerdo de privacidad" id="acuerdoprivacidad" checked />
            </div>
          </div>
  
          <div class="d-flex justify-content-center">
            <button class="btn btn-primary mt-3 mb-5" type="submit">Enviar información</button>
          </div>
    </form>
    <div class="d-flex justify-content-center mb-3 mt-3">
        <span class="span">© Todos los derechos reservados - by <a className='span-name' href="https://github.com/dorian11-byte">Dorian Raygoza</a> </span>
    </div>

    <script>
        // Example starter JavaScript for disabling form submissions if there are invalid fields
        (() => {
            'use strict'
            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            const forms = document.querySelectorAll('.needs-validation')

            // Loop over them and prevent submission
            Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                event.preventDefault()
                event.stopPropagation()
                }

                form.classList.add('was-validated')
            }, false)
            })
        })()


        document.addEventListener("DOMContentLoaded", function() {
            const siVisitaCheckbox = document.getElementById('siVisita');
            const noVisitaCheckbox = document.getElementById('noVisita');
            const calendlyContainer = document.getElementById('calendlyContainer');

            siVisitaCheckbox.addEventListener('change', function() {
            if (siVisitaCheckbox.checked) {
                calendlyContainer.style.display = 'block';
                noVisitaCheckbox.checked = false;
            } else {
                calendlyContainer.style.display = 'none';
            }
            });

            noVisitaCheckbox.addEventListener('change', function() {
            if (noVisitaCheckbox.checked) {
                calendlyContainer.style.display = 'none';
                siVisitaCheckbox.checked = false;
            }
            });
        });


        const url = "https://script.google.com/macros/s/AKfycbwKLyy88zs110AA4tHgfonh0NtuCReYTqdCqQd0JV_wedWeQVQFcyFj69HDtXVDNI_-/exec" // enter your public ('access' - 'anyone') deployment URL (NOT test deployment!)
        document.getElementById('form').action = url;

        // fetching the data from each column in the sheet
        // then populating the respective datalist
        fetch(`${url}?header=Fraccionamiento`)
            .then((response) => response.json())
            .then(({ data }) => {
                console.log(data);
                populateDatalists("Fraccionamiento", data)
            })
            .catch((error) => console.error('!!!!!!!!', error));

        fetch(`${url}?header=Nombre completo`)
            .then((response) => response.json())
            .then(({ data }) => {
                console.log(data);
                populateDatalists("Nombre completo", data)
            })
            .catch((error) => console.error('!!!!!!!!', error));
        
        fetch(`${url}?header=Address`)
            .then((response) => response.json())
            .then(({ data }) => {
                console.log(data);
                populateDatalists("addresses", data)
            })
            .catch((error) => console.error('!!!!!!!!', error));

        // function to add options to datalists
        const populateDatalists = (id, arr) => {
            let result = '';
            for (const item of arr) {
                result += `<option value="${item}">`;
            }
            document.getElementById(id).innerHTML = result;
        }

        // Handle form submission
        document.getElementById('form').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the default form submission
            const form = event.target;
            
            // Validate the form
            if (form.checkValidity()) {
                fetch(form.action, {
                    method: 'POST',
                    body: new FormData(form)
                }).then(response => {
                    if (response.ok) {
                        window.location.href = 'RegistroTerminado.html'; // Redirect to the success page
                    } else {
                        alert('Hubo un error al enviar el formulario. Por favor, inténtelo de nuevo.');
                    }
                }).catch(error => {
                    console.error('Error:', error);
                    alert('Hubo un error al enviar el formulario. Por favor, inténtelo de nuevo.');
                });
            } else {
                form.classList.add('was-validated');
            }
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="main.js"></script>
</body>
</html>